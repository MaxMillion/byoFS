//Stanford Javascript Crypto Library from https://github.com/bitwiseshiftleft/sjcl/blob/master/sjcl.js, as of commit 797bfcfa377429433d2251dde4b16db3cdc1c0cc
"use strict";function q(b){throw b}var t=void 0,u=!1;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(b){this.toString=function(){return"CORRUPT: "+this.message};this.message=b},invalid:function(b){this.toString=function(){return"INVALID: "+this.message};this.message=b},bug:function(b){this.toString=function(){return"BUG: "+this.message};this.message=b},notReady:function(b){this.toString=function(){return"NOT READY: "+this.message};this.message=b}}};"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);sjcl.cipher.aes=function(j){this.j[0][0][0]||this.D();var i,p,o,n,m=this.j[0][4],l=this.j[1];i=j.length;var k=1;4!==i&&(6!==i&&8!==i)&&q(new sjcl.exception.invalid("invalid aes key size"));this.a=[o=j.slice(0),n=[]];for(j=i;j<4*i+28;j++){p=o[j-1];if(0===j%i||8===i&&4===j%i){p=m[p>>>24]<<24^m[p>>16&255]<<16^m[p>>8&255]<<8^m[p&255],0===j%i&&(p=p<<8^p>>>24^k<<24,k=k<<1^283*(k>>7))}o[j]=o[j-i]^p}for(i=0;j;i++,j--){p=o[i&3?j:j-4],n[i]=4>=j||4>i?p:l[0][m[p>>>24]]^l[1][m[p>>16&255]]^l[2][m[p>>8&255]]^l[3][m[p&255]]}};sjcl.cipher.aes.prototype={encrypt:function(b){return y(this,b,0)},decrypt:function(b){return y(this,b,1)},j:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var N=this.j[0],M=this.j[1],L=N[4],K=M[4],J,x,w,v=[],r=[],s,j,o,i;for(J=0;256>J;J++){r[(v[J]=J<<1^283*(J>>7))^J]=J}for(x=w=0;!L[x];x^=s||1,w=r[w]||1){o=w^w<<1^w<<2^w<<3^w<<4;o=o>>8^o&255^99;L[x]=o;K[o]=x;j=v[J=v[s=v[x]]];i=16843009*j^65537*J^257*s^16843008*x;j=257*v[o]^16843008*o;for(J=0;4>J;J++){N[J][x]=j=j<<24^j>>>8,M[J][o]=i=i<<24^i>>>8}}for(J=0;5>J;J++){N[J]=N[J].slice(0),M[J]=M[J].slice(0)}}};function y(X,W,V){4!==W.length&&q(new sjcl.exception.invalid("invalid aes block size"));var U=X.a[V],T=W[0]^U[0],S=W[V?3:1]^U[1],R=W[2]^U[2];W=W[V?1:3]^U[3];var Q,O,P,M=U.length/4-2,N,L=4,J=[0,0,0,0];Q=X.j[V];X=Q[0];var K=Q[1],o=Q[2],j=Q[3],i=Q[4];for(N=0;N<M;N++){Q=X[T>>>24]^K[S>>16&255]^o[R>>8&255]^j[W&255]^U[L],O=X[S>>>24]^K[R>>16&255]^o[W>>8&255]^j[T&255]^U[L+1],P=X[R>>>24]^K[W>>16&255]^o[T>>8&255]^j[S&255]^U[L+2],W=X[W>>>24]^K[T>>16&255]^o[S>>8&255]^j[R&255]^U[L+3],L+=4,T=Q,S=O,R=P}for(N=0;4>N;N++){J[V?3&-N:N]=i[T>>>24]<<24^i[S>>16&255]<<16^i[R>>8&255]<<8^i[W&255]^U[L++],Q=T,T=S,S=R,R=W,W=Q}return J}sjcl.bitArray={bitSlice:function(e,d,f){e=sjcl.bitArray.P(e.slice(d/32),32-(d&31)).slice(1);return f===t?e:sjcl.bitArray.clamp(e,f-d)},extract:function(f,e,h){var g=Math.floor(-e-h&31);return((e+h-1^e)&-32?f[e/32|0]<<32-g^f[e/32+1|0]>>>g:f[e/32|0]>>>g)&(1<<h)-1},concat:function(f,e){if(0===f.length||0===e.length){return f.concat(e)}var h=f[f.length-1],g=sjcl.bitArray.getPartial(h);return 32===g?f.concat(e):sjcl.bitArray.P(e,g,h|0,f.slice(0,f.length-1))},bitLength:function(d){var c=d.length;return 0===c?0:32*(c-1)+sjcl.bitArray.getPartial(d[c-1])},clamp:function(e,d){if(32*e.length<d){return e}e=e.slice(0,Math.ceil(d/32));var f=e.length;d&=31;0<f&&d&&(e[f-1]=sjcl.bitArray.partial(d,e[f-1]&2147483648>>d-1,1));return e},partial:function(e,d,f){return 32===e?d:(f?d|0:d<<32-e)+1099511627776*e},getPartial:function(b){return Math.round(b/1099511627776)||32},equal:function(f,e){if(sjcl.bitArray.bitLength(f)!==sjcl.bitArray.bitLength(e)){return u}var h=0,g;for(g=0;g<f.length;g++){h|=f[g]^e[g]}return 0===h},P:function(g,f,j,i){var h;h=0;for(i===t&&(i=[]);32<=f;f-=32){i.push(j),j=0}if(0===f){return i.concat(g)}for(h=0;h<g.length;h++){i.push(j|g[h]>>>f),j=g[h]<<32-f}h=g.length?g[g.length-1]:0;g=sjcl.bitArray.getPartial(h);i.push(sjcl.bitArray.partial(f+g&31,32<f+g?j:i.pop(),1));return i},k:function(d,c){return[d[0]^c[0],d[1]^c[1],d[2]^c[2],d[3]^c[3]]}};sjcl.codec.utf8String={fromBits:function(g){var f="",j=sjcl.bitArray.bitLength(g),i,h;for(i=0;i<j/8;i++){0===(i&3)&&(h=g[i/4]),f+=String.fromCharCode(h>>>24),h<<=8}return decodeURIComponent(escape(f))},toBits:function(f){f=unescape(encodeURIComponent(f));var e=[],h,g=0;for(h=0;h<f.length;h++){g=g<<8|f.charCodeAt(h),3===(h&3)&&(e.push(g),g=0)}h&3&&e.push(sjcl.bitArray.partial(8*(h&3),g));return e}};sjcl.codec.hex={fromBits:function(e){var d="",f;for(f=0;f<e.length;f++){d+=((e[f]|0)+263882790666240).toString(16).substr(4)}return d.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(f){var e,h=[],g;f=f.replace(/\s|0x/g,"");g=f.length;f+="00000000";for(e=0;e<f.length;e+=8){h.push(parseInt(f.substr(e,8),16)^0)}return sjcl.bitArray.clamp(h,4*g)}};sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(j,i,p){var o="",n=0,m=sjcl.codec.base64.J,l=0,k=sjcl.bitArray.bitLength(j);p&&(m=m.substr(0,62)+"-_");for(p=0;6*o.length<k;){o+=m.charAt((l^j[p]>>>n)>>>26),6>n?(l=j[p]<<6-n,n+=26,p++):(l<<=6,n-=6)}for(;o.length&3&&!i;){o+="="}return o},toBits:function(j,i){j=j.replace(/\s|=/g,"");var p=[],o,n=0,m=sjcl.codec.base64.J,l=0,k;i&&(m=m.substr(0,62)+"-_");for(o=0;o<j.length;o++){k=m.indexOf(j.charAt(o)),0>k&&q(new sjcl.exception.invalid("this isn't base64!")),26<n?(n-=26,p.push(l^k>>>n),l=k<<32-n):(n+=6,l^=k<<32-n)}n&56&&p.push(sjcl.bitArray.partial(n&56,l,1));return p}};sjcl.codec.base64url={fromBits:function(b){return sjcl.codec.base64.fromBits(b,1,1)},toBits:function(b){return sjcl.codec.base64.toBits(b,1)}};sjcl.hash.sha256=function(b){this.a[0]||this.D();b?(this.q=b.q.slice(0),this.n=b.n.slice(0),this.g=b.g):this.reset()};sjcl.hash.sha256.hash=function(b){return(new sjcl.hash.sha256).update(b).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.q=this.N.slice(0);this.n=[];this.g=0;return this},update:function(e){"string"===typeof e&&(e=sjcl.codec.utf8String.toBits(e));var d,f=this.n=sjcl.bitArray.concat(this.n,e);d=this.g;e=this.g=d+sjcl.bitArray.bitLength(e);for(d=512+d&-512;d<=e;d+=512){z(this,f.splice(0,16))}return this},finalize:function(){var e,d=this.n,f=this.q,d=sjcl.bitArray.concat(d,[sjcl.bitArray.partial(1,1)]);for(e=d.length+2;e&15;e++){d.push(0)}d.push(Math.floor(this.g/4294967296));for(d.push(this.g|0);d.length;){z(this,d.splice(0,16))}this.reset();return f},N:[],a:[],D:function(){function f(b){return 4294967296*(b-Math.floor(b))|0}var e=0,h=2,g;f:for(;64>e;h++){for(g=2;g*g<=h;g++){if(0===h%g){continue f}}8>e&&(this.N[e]=f(Math.pow(h,0.5)));this.a[e]=f(Math.pow(h,1/3));e++}}};function z(R,Q){var P,O,N,M=Q.slice(0),L=R.q,K=R.a,x=L[0],J=L[1],o=L[2],w=L[3],j=L[4],T=L[5],i=L[6],S=L[7];for(P=0;64>P;P++){16>P?O=M[P]:(O=M[P+1&15],N=M[P+14&15],O=M[P&15]=(O>>>7^O>>>18^O>>>3^O<<25^O<<14)+(N>>>17^N>>>19^N>>>10^N<<15^N<<13)+M[P&15]+M[P+9&15]|0),O=O+S+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(i^j&(T^i))+K[P],S=i,i=T,T=j,j=w+O|0,w=o,o=J,J=x,x=O+(J&o^w&(J^o))+(J>>>2^J>>>13^J>>>22^J<<30^J<<19^J<<10)|0}L[0]=L[0]+x|0;L[1]=L[1]+J|0;L[2]=L[2]+o|0;L[3]=L[3]+w|0;L[4]=L[4]+j|0;L[5]=L[5]+T|0;L[6]=L[6]+i|0;L[7]=L[7]+S|0}sjcl.mode.ccm={name:"ccm",encrypt:function(w,v,s,r,p){var o,n=v.slice(0),m=sjcl.bitArray,i=m.bitLength(s)/8,j=m.bitLength(n)/8;p=p||64;r=r||[];7>i&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(o=2;4>o&&j>>>8*o;o++){}o<15-i&&(o=15-i);s=m.clamp(s,8*(15-o));v=sjcl.mode.ccm.L(w,v,s,r,p,o);n=sjcl.mode.ccm.o(w,n,s,v,p,o);return m.concat(n.data,n.tag)},decrypt:function(w,v,s,r,p){p=p||64;r=r||[];var o=sjcl.bitArray,n=o.bitLength(s)/8,m=o.bitLength(v),i=o.clamp(v,m-p),j=o.bitSlice(v,m-p),m=(m-p)/8;7>n&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));for(v=2;4>v&&m>>>8*v;v++){}v<15-n&&(v=15-n);s=o.clamp(s,8*(15-v));i=sjcl.mode.ccm.o(w,i,s,j,p,v);w=sjcl.mode.ccm.L(w,i.data,s,r,p,v);o.equal(i.tag,w)||q(new sjcl.exception.corrupt("ccm: tag doesn't match"));return i.data},L:function(s,r,p,o,n,m){var k=[],j=sjcl.bitArray,i=j.k;n/=8;(n%2||4>n||16<n)&&q(new sjcl.exception.invalid("ccm: invalid tag length"));(4294967295<o.length||4294967295<r.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data"));m=[j.partial(8,(o.length?64:0)|n-2<<2|m-1)];m=j.concat(m,p);m[3]|=j.bitLength(r)/8;m=s.encrypt(m);if(o.length){p=j.bitLength(o)/8;65279>=p?k=[j.partial(16,p)]:4294967295>=p&&(k=j.concat([j.partial(16,65534)],[p]));k=j.concat(k,o);for(o=0;o<k.length;o+=4){m=s.encrypt(i(m,k.slice(o,o+4).concat([0,0,0])))}}for(o=0;o<r.length;o+=4){m=s.encrypt(i(m,r.slice(o,o+4).concat([0,0,0])))}return j.clamp(m,8*n)},o:function(w,v,s,r,p,o){var n,m=sjcl.bitArray;n=m.k;var i=v.length,j=m.bitLength(v);s=m.concat([m.partial(8,o-1)],s).concat([0,0,0]).slice(0,4);r=m.bitSlice(n(r,w.encrypt(s)),0,p);if(!i){return{tag:r,data:[]}}for(n=0;n<i;n+=4){s[3]++,p=w.encrypt(s),v[n]^=p[0],v[n+1]^=p[1],v[n+2]^=p[2],v[n+3]^=p[3]}return{tag:r,data:m.clamp(v,j)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(N,M,L,K,J,x){128!==sjcl.bitArray.bitLength(L)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var w,v=sjcl.mode.ocb2.H,r=sjcl.bitArray,s=r.k,j=[0,0,0,0];L=v(N.encrypt(L));var o,i=[];K=K||[];J=J||64;for(w=0;w+4<M.length;w+=4){o=M.slice(w,w+4),j=s(j,o),i=i.concat(s(L,N.encrypt(s(L,o)))),L=v(L)}o=M.slice(w);M=r.bitLength(o);w=N.encrypt(s(L,[0,0,0,M]));o=r.clamp(s(o.concat([0,0,0]),w),M);j=s(j,s(o.concat([0,0,0]),w));j=N.encrypt(s(j,s(L,v(L))));K.length&&(j=s(j,x?K:sjcl.mode.ocb2.pmac(N,K)));return i.concat(r.concat(o,r.clamp(j,J)))},decrypt:function(Q,P,O,N,M,L){128!==sjcl.bitArray.bitLength(O)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));M=M||64;var K=sjcl.mode.ocb2.H,J=sjcl.bitArray,w=J.k,x=[0,0,0,0],o=K(Q.encrypt(O)),v,j,R=sjcl.bitArray.bitLength(P)-M,i=[];N=N||[];for(O=0;O+4<R/32;O+=4){v=w(o,Q.decrypt(w(o,P.slice(O,O+4)))),x=w(x,v),i=i.concat(v),o=K(o)}j=R-32*O;v=Q.encrypt(w(o,[0,0,0,j]));v=w(v,J.clamp(P.slice(O),j).concat([0,0,0]));x=w(x,v);x=Q.encrypt(w(x,w(o,K(o))));N.length&&(x=w(x,L?N:sjcl.mode.ocb2.pmac(Q,N)));J.equal(J.clamp(x,M),J.bitSlice(P,R))||q(new sjcl.exception.corrupt("ocb: tag doesn't match"));return i.concat(J.clamp(v,j))},pmac:function(j,i){var p,o=sjcl.mode.ocb2.H,n=sjcl.bitArray,m=n.k,l=[0,0,0,0],k=j.encrypt([0,0,0,0]),k=m(k,o(o(k)));for(p=0;p+4<i.length;p+=4){k=o(k),l=m(l,j.encrypt(m(k,i.slice(p,p+4))))}p=i.slice(p);128>n.bitLength(p)&&(k=m(k,o(k)),p=n.concat(p,[-2147483648,0,0,0]));l=m(l,p);return j.encrypt(m(o(m(k,o(k))),l))},H:function(b){return[b[0]<<1^b[1]>>>31,b[1]<<1^b[2]>>>31,b[2]<<1^b[3]>>>31,b[3]<<1^135*(b[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(h,g,l,k,j){var i=g.slice(0);g=sjcl.bitArray;k=k||[];h=sjcl.mode.gcm.o(!0,h,i,k,l,j||128);return g.concat(h.data,h.tag)},decrypt:function(j,i,p,o,n){var m=i.slice(0),l=sjcl.bitArray,k=l.bitLength(m);n=n||128;o=o||[];n<=k?(i=l.bitSlice(m,k-n),m=l.bitSlice(m,0,k-n)):(i=m,m=[]);j=sjcl.mode.gcm.o(u,j,m,o,p,n);l.equal(j.tag,i)||q(new sjcl.exception.corrupt("gcm: tag doesn't match"));return j.data},W:function(j,i){var p,o,n,m,l,k=sjcl.bitArray.k;n=[0,0,0,0];m=i.slice(0);for(p=0;128>p;p++){(o=0!==(j[Math.floor(p/32)]&1<<31-p%32))&&(n=k(n,m));l=0!==(m[3]&1);for(o=3;0<o;o--){m[o]=m[o]>>>1|(m[o-1]&1)<<31}m[0]>>>=1;l&&(m[0]^=-520093696)}return n},f:function(g,f,j){var i,h=j.length;f=f.slice(0);for(i=0;i<h;i+=4){f[0]^=4294967295&j[i],f[1]^=4294967295&j[i+1],f[2]^=4294967295&j[i+2],f[3]^=4294967295&j[i+3],f=sjcl.mode.gcm.W(f,g)}return f},o:function(Q,P,O,N,M,L){var K,J,w,x,o,v,j,R,i=sjcl.bitArray;v=O.length;j=i.bitLength(O);R=i.bitLength(N);J=i.bitLength(M);K=P.encrypt([0,0,0,0]);96===J?(M=M.slice(0),M=i.concat(M,[1])):(M=sjcl.mode.gcm.f(K,[0,0,0,0],M),M=sjcl.mode.gcm.f(K,M,[0,0,Math.floor(J/4294967296),J&4294967295]));J=sjcl.mode.gcm.f(K,[0,0,0,0],N);o=M.slice(0);N=J.slice(0);Q||(N=sjcl.mode.gcm.f(K,J,O));for(x=0;x<v;x+=4){o[3]++,w=P.encrypt(o),O[x]^=w[0],O[x+1]^=w[1],O[x+2]^=w[2],O[x+3]^=w[3]}O=i.clamp(O,j);Q&&(N=sjcl.mode.gcm.f(K,J,O));Q=[Math.floor(R/4294967296),R&4294967295,Math.floor(j/4294967296),j&4294967295];N=sjcl.mode.gcm.f(K,N,Q);w=P.encrypt(M);N[0]^=w[0];N[1]^=w[1];N[2]^=w[2];N[3]^=w[3];return{tag:i.bitSlice(N,0,L),data:O}}};sjcl.misc.hmac=function(g,f){this.M=f=f||sjcl.hash.sha256;var j=[[],[]],i,h=f.prototype.blockSize/32;this.m=[new f,new f];g.length>h&&(g=f.hash(g));for(i=0;i<h;i++){j[0][i]=g[i]^909522486,j[1][i]=g[i]^1549556828}this.m[0].update(j[0]);this.m[1].update(j[1]);this.G=new f(this.m[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(b){this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!"));this.update(b);return this.digest(b)};sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.m[0]);this.Q=u};sjcl.misc.hmac.prototype.update=function(b){this.Q=!0;this.G.update(b)};sjcl.misc.hmac.prototype.digest=function(){var b=this.G.finalize(),b=(new this.M(this.m[1])).update(b).finalize();this.reset();return b};sjcl.misc.pbkdf2=function(J,x,w,v,s){w=w||1000;(0>v||0>w)&&q(sjcl.exception.invalid("invalid params to pbkdf2"));"string"===typeof J&&(J=sjcl.codec.utf8String.toBits(J));"string"===typeof x&&(x=sjcl.codec.utf8String.toBits(x));s=s||sjcl.misc.hmac;J=new s(J);var r,p,o,j,m=[],i=sjcl.bitArray;for(j=1;32*m.length<(v||1);j++){s=r=J.encrypt(i.concat(x,[j]));for(p=1;p<w;p++){r=J.encrypt(r);for(o=0;o<r.length;o++){s[o]^=r[o]}}m=m.concat(s)}v&&(m=i.clamp(m,v));return m};sjcl.prng=function(b){this.b=[new sjcl.hash.sha256];this.h=[0];this.F=0;this.t={};this.C=0;this.K={};this.O=this.c=this.i=this.V=0;this.a=[0,0,0,0,0,0,0,0];this.e=[0,0,0,0];this.A=t;this.B=b;this.p=u;this.z={progress:{},seeded:{}};this.l=this.U=0;this.u=1;this.w=2;this.S=65536;this.I=[0,48,64,96,128,192,256,384,512,768,1024];this.T=30000;this.R=80};sjcl.prng.prototype={randomWords:function(i,h){var n=[],m;m=this.isReady(h);var l;m===this.l&&q(new sjcl.exception.notReady("generator isn't seeded"));if(m&this.w){m=!(m&this.u);l=[];var k=0,j;this.O=l[0]=(new Date).valueOf()+this.T;for(j=0;16>j;j++){l.push(4294967296*Math.random()|0)}for(j=0;j<this.b.length&&!(l=l.concat(this.b[j].finalize()),k+=this.h[j],this.h[j]=0,!m&&this.F&1<<j);j++){}this.F>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.h.push(0));this.c-=k;k>this.i&&(this.i=k);this.F++;this.a=sjcl.hash.sha256.hash(this.a.concat(l));this.A=new sjcl.cipher.aes(this.a);for(m=0;4>m&&!(this.e[m]=this.e[m]+1|0,this.e[m]);m++){}}for(m=0;m<i;m+=4){0===(m+1)%this.S&&A(this),l=B(this),n.push(l[0],l[1],l[2],l[3])}A(this);return n.slice(0,i)},setDefaultParanoia:function(d,c){0===d&&"Setting paranoia=0 will ruin your security; use it only for testing"!==c&&q("Setting paranoia=0 will ruin your security; use it only for testing");this.B=d},addEntropy:function(s,r,p){p=p||"user";var o,n,m=(new Date).valueOf(),k=this.t[p],j=this.isReady(),i=0;o=this.K[p];o===t&&(o=this.K[p]=this.V++);k===t&&(k=this.t[p]=0);this.t[p]=(this.t[p]+1)%this.b.length;switch(typeof s){case"number":r===t&&(r=1);this.b[k].update([o,this.C++,1,r,m,1,s|0]);break;case"object":p=Object.prototype.toString.call(s);if("[object Uint32Array]"===p){n=[];for(p=0;p<s.length;p++){n.push(s[p])}s=n}else{"[object Array]"!==p&&(i=1);for(p=0;p<s.length&&!i;p++){"number"!==typeof s[p]&&(i=1)}}if(!i){if(r===t){for(p=r=0;p<s.length;p++){for(n=s[p];0<n;){r++,n>>>=1}}}this.b[k].update([o,this.C++,2,r,m,s.length].concat(s))}break;case"string":r===t&&(r=s.length);this.b[k].update([o,this.C++,3,r,m,s.length]);this.b[k].update(s);break;default:i=1}i&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string"));this.h[k]+=r;this.c+=r;j===this.l&&(this.isReady()!==this.l&&C("seeded",Math.max(this.i,this.c)),C("progress",this.getProgress()))},isReady:function(b){b=this.I[b!==t?b:this.B];return this.i&&this.i>=b?this.h[0]>this.R&&(new Date).valueOf()>this.O?this.w|this.u:this.u:this.c>=b?this.w|this.l:this.l},getProgress:function(b){b=this.I[b?b:this.B];return this.i>=b?1:this.c>b?1:this.c/b},startCollectors:function(){this.p||(window.addEventListener?(window.addEventListener("load",this.r,u),window.addEventListener("mousemove",this.s,u)):document.attachEvent?(document.attachEvent("onload",this.r),document.attachEvent("onmousemove",this.s)):q(new sjcl.exception.bug("can't attach event")),this.p=!0)},stopCollectors:function(){this.p&&(window.removeEventListener?(window.removeEventListener("load",this.r,u),window.removeEventListener("mousemove",this.s,u)):window.detachEvent&&(window.detachEvent("onload",this.r),window.detachEvent("onmousemove",this.s)),this.p=u)},addEventListener:function(d,c){this.z[d][this.U++]=c},removeEventListener:function(h,g){var l,k,j=this.z[h],i=[];for(k in j){j.hasOwnProperty(k)&&j[k]===g&&i.push(k)}for(l=0;l<i.length;l++){k=i[l],delete j[k]}},s:function(b){sjcl.random.addEntropy([b.x||b.clientX||b.offsetX||0,b.y||b.clientY||b.offsetY||0],2,"mouse");D(0)},r:function(){D(2)}};function C(g,f){var j,i=sjcl.random.z[g],h=[];for(j in i){i.hasOwnProperty(j)&&h.push(i[j])}for(j=0;j<h.length;j++){h[j](f)}}function D(b){window&&window.performance&&"function"===typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),b,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),b,"loadtime")}function A(b){b.a=B(b).concat(B(b));b.A=new sjcl.cipher.aes(b.a)}function B(d){for(var c=0;4>c&&!(d.e[c]=d.e[c]+1|0,d.e[c]);c++){}return d.A.encrypt(d.e)}sjcl.random=new sjcl.prng(6);try{var E,F,G,H;"undefined"!==typeof module&&module.exports?(F=require("crypto"),E=F.randomBytes(128),sjcl.random.addEntropy(E,1024,"crypto['randomBytes']")):window&&(window.crypto&&window.crypto.getRandomValues?G=window.crypto.getRandomValues:window.msCrypto&&window.msCrypto.getRandomValues&&(G=window.msCrypto.getRandomValues),G&&(H=new Uint32Array(32),G(H),sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']")))}catch(I){}sjcl.json={defaults:{v:1,iter:1000,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(i,h,n,m){n=n||{};m=m||{};var l=sjcl.json,k=l.d({iv:sjcl.random.randomWords(4,0)},l.defaults),j;l.d(k,n);n=k.adata;"string"===typeof k.salt&&(k.salt=sjcl.codec.base64.toBits(k.salt));"string"===typeof k.iv&&(k.iv=sjcl.codec.base64.toBits(k.iv));(!sjcl.mode[k.mode]||!sjcl.cipher[k.cipher]||"string"===typeof i&&100>=k.iter||64!==k.ts&&96!==k.ts&&128!==k.ts||128!==k.ks&&192!==k.ks&&256!==k.ks||2>k.iv.length||4<k.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters"));"string"===typeof i?(j=sjcl.misc.cachedPbkdf2(i,k),i=j.key.slice(0,k.ks/32),k.salt=j.salt):sjcl.ecc&&i instanceof sjcl.ecc.elGamal.publicKey&&(j=i.kem(),k.kemtag=j.tag,i=j.key.slice(0,k.ks/32));"string"===typeof h&&(h=sjcl.codec.utf8String.toBits(h));"string"===typeof n&&(n=sjcl.codec.utf8String.toBits(n));j=new sjcl.cipher[k.cipher](i);l.d(m,k);m.key=i;k.ct=sjcl.mode[k.mode].encrypt(j,h,k.iv,n,k.ts);return l.encode(k)},decrypt:function(h,g,l,k){l=l||{};k=k||{};var j=sjcl.json;g=j.d(j.d(j.d({},j.defaults),j.decode(g)),l,!0);var i;l=g.adata;"string"===typeof g.salt&&(g.salt=sjcl.codec.base64.toBits(g.salt));"string"===typeof g.iv&&(g.iv=sjcl.codec.base64.toBits(g.iv));(!sjcl.mode[g.mode]||!sjcl.cipher[g.cipher]||"string"===typeof h&&100>=g.iter||64!==g.ts&&96!==g.ts&&128!==g.ts||128!==g.ks&&192!==g.ks&&256!==g.ks||!g.iv||2>g.iv.length||4<g.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters"));"string"===typeof h?(i=sjcl.misc.cachedPbkdf2(h,g),h=i.key.slice(0,g.ks/32),g.salt=i.salt):sjcl.ecc&&h instanceof sjcl.ecc.elGamal.secretKey&&(h=h.unkem(sjcl.codec.base64.toBits(g.kemtag)).slice(0,g.ks/32));"string"===typeof l&&(l=sjcl.codec.utf8String.toBits(l));i=new sjcl.cipher[g.cipher](h);l=sjcl.mode[g.mode].decrypt(i,g.ct,g.iv,l,g.ts);j.d(k,g);k.key=h;return sjcl.codec.utf8String.fromBits(l)},encode:function(f){var e,h="{",g="";for(e in f){if(f.hasOwnProperty(e)){switch(e.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),h+=g+'"'+e+'":',g=",",typeof f[e]){case"number":case"boolean":h+=f[e];break;case"string":h+='"'+escape(f[e])+'"';break;case"object":h+='"'+sjcl.codec.base64.fromBits(f[e],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}}}return h+"}"},decode:function(f){f=f.replace(/\s/g,"");f.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!"));f=f.replace(/^\{|\}$/g,"").split(/,/);var e={},h,g;for(h=0;h<f.length;h++){(g=f[h].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),e[g[2]]=g[3]?parseInt(g[3],10):g[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(g[4]):unescape(g[4])}return e},d:function(f,e,h){f===t&&(f={});if(e===t){return f}for(var g in e){e.hasOwnProperty(g)&&(h&&(f[g]!==t&&f[g]!==e[g])&&q(new sjcl.exception.invalid("required parameter overridden")),f[g]=e[g])}return f},Z:function(f,e){var h={},g;for(g in f){f.hasOwnProperty(g)&&f[g]!==e[g]&&(h[g]=f[g])}return h},Y:function(f,e){var h={},g;for(g=0;g<e.length;g++){f[e[g]]!==t&&(h[e[g]]=f[e[g]])}return h}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.X={};sjcl.misc.cachedPbkdf2=function(f,e){var h=sjcl.misc.X,g;e=e||{};g=e.iter||1000;h=h[f]=h[f]||{};g=h[g]=h[g]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)};h=e.salt===t?g.firstSalt:e.salt;g[h]=g[h]||sjcl.misc.pbkdf2(f,h,e.iter);return{key:g[h].slice(0),salt:h.slice(0)}};

//byoFS javascript library, GPLv2, https://github.com/diafygi/byoFS
var byoFS=(function(){var a="";a+=".byoFS-auth{padding:10px;border-radius:10px;background-color:#274257;color:#EEEEEE;font-size:14px;font-family:sans-serif;}";a+=".byoFS-auth p{}";a+=".byoFS-auth ul{margin-top:10px;}";a+=".byoFS-auth li{display:inline-block;margin-left:12px;}";a+=".byoFS-auth li:nth-child(1){margin-left:0px;}";a+=".byoFS-auth a{display:block;padding:8px;border-radius:5px;color:#FFFFFF;text-decoration:none;}";a+="a.byoFS-auth-db{padding-left:31px;background-color:#7EB5D6;background-repeat:no-repeat;background-position:left center;background-image:url('data:image/png;base64,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');}";a+="a.byoFS-auth-ls{padding-left:31px;background-color:#FCAB52;background-repeat:no-repeat;background-position:left center;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANxSURBVEiJxZdNaFxVFMd/585MqmYaa9M2xqSGlpRIDYKgdiFuGjDdmJ3u1KVIoTtxKxQEl9KFO3ciFhEsIinUjSGgUGMXrdGaIhoqvpmaaTKTmc7Mu/d08ebjzbw7H4VADjzmzXv3nN/9n/fOufeJqrIfZvaFup/gdPxP/q35bO1BfWPPKaIrU9/efrMn+Ojlm6W7S3NPAo8NFW+IfKkDnITd19OesQEwMyigScPokVTfMWFNqWw5QIOEfw/wnpjaJkUSMT2KJYB2iZlXFkAkMcqIJXM06wW6wn/YjbUozYAwBFjQIF7Zmbc/gNGDSXAhx+OnTnvB9dVvqGysoS6KpLjBqdau2enOljd4P3M79yLfhmKHGaxYcTmhnVrd2UImZ0CV8POP2zMWR+WYP9X271sd4LTWcwPBRiXQ+CPdKUS/ItgbK7BbjIKmoT7grW6Cd8Ok4kSqu9OixULrXMYO9wUlYkXPeHv2+z+r3fcSilNqAyfxVLfBmQufQC2KYcr3GZ054QVWPruAy29GisVfngmwDUcCGam3L8TAMnG8fV7IkZqe84K1XIygCtoDnEj19NVbBaBF1vt5qJSSR7WMVoqtA9foFs6i5e1YDSe7llcxqsrSXA6YAnA3VqmeX0zOOA3F2MuV/egK5plZtLgFqrEaTjYPPziaZwA6BSBjT5F+98NIzPp17LWv/R5j49GYYlT3/bpWH3A7PVqrYl58rRHF+MEmhYweisbv/N8B9i0Q0Hsj0B78oNx6k+X4LOblsx0t1Bx7lpGFd1r9XBuKG6WE6CMoFujo11osIONPI+MTZN6/GMlZv0729AuYI9MdvtrVLhU7vGLtWhrd2o9QLsVmZjCTMwmoy29i7/zaAU6TGl6xokG8X4dffkr41SXMyecx82eQ+TOYQ4fRahn7+8+Ev60S3lzB5TfbMZrVRdELFt/29u4bcwsI13wOTTNjWUYP1sEmdjUA7OYtzlKauvJHck2lh2KnqcCI9d1qW7kET8QWCY22OramhFVt9pOeuxkveKSe+csesJcUPQdyqpezC5WwCmFVsXWNb1xC4CdUv+jl60113IKl506EwjlVXRQ4C3hTB/KPiF516HLtgP3h5OU72/3iDgTH7Zf3XspM/Lv7qhG3qMjrCvcEXTZOlye/u70+dKBHBe+l7dsnzEMkv6CzOVeWJAAAAABJRU5ErkJggg==');}";a+=".byoFS-db{padding:10px;border-radius:10px;color:#444444;background-color:#7EB5D6;font-size:14px;font-family:sans-serif;}";a+=".byoFS-db p{margin-top:5px;}";a+=".byoFS-db p:nth-child(1){margin-top:0px;padding:8px 0px 8px 31px;background-repeat:no-repeat;background-position:left center;background-image:url('data:image/png;base64,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');}";a+=".byoFS-db input{width:212px;border:none;border-radius:5px;padding:4px 6px;}";a+=".byoFS-db a{display:inline-block;padding:4px 8px;border-radius:5px;color:#FFFFFF;background-color:#274257;text-decoration:none;}";a+=".byoFS-db-connecting{padding:10px;border-radius:10px;color:#444444;background-color:#7EB5D6;font-size:14px;font-family:sans-serif;}";a+=".byoFS-db-connected{padding:10px;border-radius:10px;color:#444444;background-color:#7EB5D6;font-size:14px;font-family:sans-serif;}";a+=".byoFS-ls{padding:10px;border-radius:10px;color:#444444;background-color:#FCAB52;font-size:14px;font-family:sans-serif;}";a+=".byoFS-ls p{margin-top:5px;}";a+=".byoFS-ls p:nth-child(1){margin-top:0px;padding:8px 0px 8px 31px;background-repeat:no-repeat;background-position:left center;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANxSURBVEiJxZdNaFxVFMd/585MqmYaa9M2xqSGlpRIDYKgdiFuGjDdmJ3u1KVIoTtxKxQEl9KFO3ciFhEsIinUjSGgUGMXrdGaIhoqvpmaaTKTmc7Mu/d08ebjzbw7H4VADjzmzXv3nN/9n/fOufeJqrIfZvaFup/gdPxP/q35bO1BfWPPKaIrU9/efrMn+Ojlm6W7S3NPAo8NFW+IfKkDnITd19OesQEwMyigScPokVTfMWFNqWw5QIOEfw/wnpjaJkUSMT2KJYB2iZlXFkAkMcqIJXM06wW6wn/YjbUozYAwBFjQIF7Zmbc/gNGDSXAhx+OnTnvB9dVvqGysoS6KpLjBqdau2enOljd4P3M79yLfhmKHGaxYcTmhnVrd2UImZ0CV8POP2zMWR+WYP9X271sd4LTWcwPBRiXQ+CPdKUS/ItgbK7BbjIKmoT7grW6Cd8Ok4kSqu9OixULrXMYO9wUlYkXPeHv2+z+r3fcSilNqAyfxVLfBmQufQC2KYcr3GZ054QVWPruAy29GisVfngmwDUcCGam3L8TAMnG8fV7IkZqe84K1XIygCtoDnEj19NVbBaBF1vt5qJSSR7WMVoqtA9foFs6i5e1YDSe7llcxqsrSXA6YAnA3VqmeX0zOOA3F2MuV/egK5plZtLgFqrEaTjYPPziaZwA6BSBjT5F+98NIzPp17LWv/R5j49GYYlT3/bpWH3A7PVqrYl58rRHF+MEmhYweisbv/N8B9i0Q0Hsj0B78oNx6k+X4LOblsx0t1Bx7lpGFd1r9XBuKG6WE6CMoFujo11osIONPI+MTZN6/GMlZv0729AuYI9MdvtrVLhU7vGLtWhrd2o9QLsVmZjCTMwmoy29i7/zaAU6TGl6xokG8X4dffkr41SXMyecx82eQ+TOYQ4fRahn7+8+Ev60S3lzB5TfbMZrVRdELFt/29u4bcwsI13wOTTNjWUYP1sEmdjUA7OYtzlKauvJHck2lh2KnqcCI9d1qW7kET8QWCY22OramhFVt9pOeuxkveKSe+csesJcUPQdyqpezC5WwCmFVsXWNb1xC4CdUv+jl60113IKl506EwjlVXRQ4C3hTB/KPiF516HLtgP3h5OU72/3iDgTH7Zf3XspM/Lv7qhG3qMjrCvcEXTZOlye/u70+dKBHBe+l7dsnzEMkv6CzOVeWJAAAAABJRU5ErkJggg==');}";a+=".byoFS-ls input{width:212px;border:none;border-radius:5px;padding:4px 6px;}";a+=".byoFS-ls a{display:inline-block;padding:4px 8px;border-radius:5px;color:#FFFFFF;background-color:#E44D26;text-decoration:none;}";a+=".byoFS-ls-connected{padding:10px;border-radius:10px;color:#444444;background-color:#FCAB52;font-size:14px;font-family:sans-serif;}";if(!document.getElementById("byoFS-css")){var c=document.createElement("style");c.id="byoFS-css";document.getElementsByTagName("head")[0].appendChild(c);document.getElementById("byoFS-css").innerHTML=a;a=null}var b={auth:'<div class="byoFS-auth"><p>Load from:</p><ul><li><a href="#" class="byoFS-auth-db">Dropbox</a></li><li><a href="#" class="byoFS-auth-ls">localStorage</a></li></ul></div>',db:'<div class="byoFS-db"><p>Dropbox Code:</p><p><input class="byoFS-db-code"></p><p>Decrypt Password:</p><p><input type="password" class="byoFS-db-pass"></p><p><a href="#" class="byoFS-db-submit">Decrypt</a> <a href="#" class="byoFS-reset">Go Back</a></p></div>',dbcon:'<div class="byoFS-db-connecting"><p>Verifying...</p></div>',dbconnected:'<div class="byoFS-db-connected"><p>Connected!</p></div>',ls:'<div class="byoFS-ls"><p>Decrypt Password:</p><p><input type="password" class="byoFS-ls-pass"></p><p><a href="#" class="byoFS-ls-submit">Decrypt</a> <a href="#" class="byoFS-reset">Go Back</a></p></div>',lsconnected:'<div class="byoFS-ls-connected"><p>Connected!</p></div>'};return function(d,e,f){document.querySelector(e).innerHTML=b.auth;document.querySelector(e).querySelector(".byoFS-auth-db").addEventListener("click",function(g){g.preventDefault();window.open("https://www.dropbox.com/1/oauth2/authorize?response_type=code&client_id=9xzbrduyt7rznbw","_blank");document.querySelector(e).innerHTML=b.db;document.querySelector(e).querySelector(".byoFS-reset").addEventListener("click",function(h){h.preventDefault();byoFS(e,f)});document.querySelector(e).querySelector(".byoFS-db-submit").addEventListener("click",function(i){i.preventDefault();document.querySelector(e).innerHTML=b.dbcon;var j="code="+encodeURIComponent(i.target.parentElement.parentElement.querySelector(".byoFS-db-code").value);j+="&grant_type=authorization_code";j+="&client_id=9xzbrduyt7rznbw";j+="&client_secret=g7jnj93mqluqazh";var h=new XMLHttpRequest();h.open("POST","https://api.dropbox.com/1/oauth2/token");h.onreadystatechange=function(){if(h.readyState===4){if(h.status===200){var k=JSON.parse(h.responseText)["access_token"];var m=i.target.parentElement.parentElement.querySelector(".byoFS-db-pass").value;var l={read:function(n,p){n=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(n));var o=new XMLHttpRequest();o.open("GET","https://api-content.dropbox.com/1/files/sandbox/"+d+"-"+n+".txt");o.onreadystatechange=function(){if(o.readyState===4){if(o.status===200){try{var r=sjcl.decrypt(m,JSON.parse(o.responseText));p(r)}catch(q){console.log(q);alert("Couldn't decrypt :(");byoFS(d,e,p)}}else{if(o.status==404){p(null)}else{console.log("errorget");console.log(o)}}}};o.setRequestHeader("Authorization","Bearer "+k);o.send()},write:function(n,o,q){n=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(n));if(o===null){var p=new XMLHttpRequest();p.open("POST","https://api.dropbox.com/1/fileops/delete?root=sandbox&path="+d+"-"+n+".txt");p.onreadystatechange=function(){if(p.readyState===4){if(p.status===200){q(true)}else{if(p.status==404){q(null)}else{console.log("errordel");console.log(p)}}}};p.setRequestHeader("Authorization","Bearer "+k);p.send()}else{o=JSON.stringify(sjcl.encrypt(m,o));var p=new XMLHttpRequest();p.open("POST","https://api-content.dropbox.com/1/files_put/sandbox/"+d+"-"+n+".txt");p.onreadystatechange=function(){if(p.readyState===4){if(p.status===200){q(true)}else{if(p.status==404){q(null)}else{console.log("errorwrite");console.log(p)}}}};p.setRequestHeader("Authorization","Bearer "+k);p.setRequestHeader("Content-Type","text/plain");p.send(o)}}};document.querySelector(e).innerHTML=b.dbconnected;f(l)}else{if(h.status==400){alert("Something went wrong :( Did you copy your code correctly?");byoFS(d,e,f)}else{console.log("errortoken");console.log(h)}}}};h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(j)})});document.querySelector(e).querySelector(".byoFS-auth-ls").addEventListener("click",function(g){g.preventDefault();document.querySelector(e).innerHTML=b.ls;document.querySelector(e).querySelector(".byoFS-reset").addEventListener("click",function(h){h.preventDefault();byoFS(d,e,f)});document.querySelector(e).querySelector(".byoFS-ls-submit").addEventListener("click",function(j){j.preventDefault();var i=j.target.parentElement.parentElement.querySelector(".byoFS-ls-pass").value;var h={read:function(k,l){k=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(k));if(localStorage[d+"-"+k]){data=sjcl.decrypt(i,localStorage[d+"-"+k])}else{data=null}l(data)},write:function(k,l,m){k=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(k));if(l===null){if(localStorage[d+"-"+k]!==undefined){localStorage.removeItem(d+"-"+k)}m(true)}else{localStorage.setItem(d+"-"+k,sjcl.encrypt(i,l));m(true)}}};document.querySelector(e).innerHTML=b.lsconnected;f(h)})})}})();
